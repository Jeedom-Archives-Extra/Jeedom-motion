<div class="eqLogic eqLogic-widget allowResize" data-eqLogic_id="#id#" data-version="dashboard" style="background-color: #background_color#;height: #height#;width: #width#;#style#;min-height: 80px;min-weight:80px;">
	<script type="text/javascript" src="plugins/motion/desktop/js/jquery.maphilight.min.js"></script>	
	<span class="statusCmd" style="position : absolute;left : 5px;bottom:0px; width : 30px;z-index: 1030;"></span>
	<center class="widget-name">
        	<span style="font-weight:bold;"><a href="#eqLink#">#name#</a></span>
	</center>
	<center>	
        	<span>
			<span class="Detection" style="position:absolute;right:0;">#detect#</span>
			<img id="fluxVideo" class="img-responsive" usemap="#map#id#" src="plugins/motion/core/php/stream.php?url=#url#" alt="" data-eqLogic_id="#id#" style="z-index:1"/>
  			<map class="MapHiLight" name="map#id#" id="map#id#"></map>
			#maphilightArea#
	    	</span>
        	#action#
        	<span class="cmd cmd-widget" data-type="action" data-subtype="other">
        	    <a class="camera_history btn btn-default btn-sm folder" data-eqLogic_id="#id#" style="background-color:#cmdColor# !important;border-color : transparent !important;"><i class="fa fa-folder-open"></i></a>
        	</span>
    	</center>
	<script>
		$('.camera_history[data-eqLogic_id=#id#]').off().on('click', function () {
			$('#md_modal').dialog({title: "Historique #name#"});
			$('#md_modal').load('index.php?v=d&plugin=motion&modal=motion.history&id=#id#').dialog('open');
		});
		var onImgLoad = function(selector, callback){
			$(selector).each(function(){
				if (this.complete || /*for IE 10-*/ $(this).height() > 0) {
					callback.apply(this);
				}else {
					$(this).on('load', function(){
						callback.apply(this);
					});
				}
			});
		};
		onImgLoad('.eqLogic[data-eqLogic_id=#id#] #fluxVideo', function(){
			var x=$(this).get(0).naturalWidth / $(this).width();
			var y=$(this).get(0).naturalHeight / $(this).height();
			$(this).closest('.eqLogic').find('area').each(function(){
				var coords=$(this).attr('coords');
				var newCoords=[];
				$.each(coords.split(','),function(index, value){
					newCoords.push(value/x);
				});
				$(this).attr('coords',newCoords.toString());
			});
			$(this).maphilight();
		});
	</script>
</div>
